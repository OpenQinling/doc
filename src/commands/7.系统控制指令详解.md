# 系统控制指令详解

```
      +--->[31:29]系统指令编号     
      |       +---> [24:0]各系统控制指令自由分配
      |       |
      vvv     v vvvv vvvv vvvv vvvv vvvv vvvv
    0b0000 0000 0000 0000 0000 0000 0000 0000
         ^ ^^^
         |
         +---> [28:25]系统控制指令类型
```

## 重启指令 

重启CPU，并向所有外设内设发出重启信号，*保护模式下该指令无效*

汇编表示：`RST`

二进制表示：系统指令编号为`0b000`
```  
         +--->[31:29]系统指令编号(0b000) 
         |
         v vvv
    0b0000 000x xxxx xxxx xxxx xxxx xxxx xxxx
              ^ ^^^^ ^^^^ ^^^^ ^^^^ ^^^^ ^^^^
              |
              +---> [24:0]任意值
```

## 软中断指令

触发一个编号为`<软中断号>`的中断，*未开启总中断响应时该指令无效*

软中断只支持中断号0x10~0xFF（16-255），小于16将触发CPU异常（中断号0）

汇编表示：`SINT <软中断号>`

二进制表示：系统指令编号为`0b001`
```  
         +--->[31:29]系统指令编号(0b001) 
         |                          +-->[7:0]软中断号(0x10~0xFF)
         |                          |
         v vvv                      vvvv vvvv
    0b0000 001x xxxx xxxx xxxx xxxx CCCC CCCC
              ^ ^^^^ ^^^^ ^^^^ ^^^^ 
              |
              +---> [24:8]任意值
```

*注：中断及异常处理机制介绍[参见](./5.中断及异常处理机制介绍.md)*


## 权限控制指令

| 汇编表示   | 权限控制指令编号 | 解释                                 |
| ---------- | ---------------- | ------------------------------------ |
| `EI`       | `0b00`           | 开启中断响应                         |
| `DI`       | `0b01`           | 关闭中断响应，*保护模式下该指令无效* |
| `EP`       | `0b10`           | 开启保护模式                         |
| 无（保留） | `0b11~u25::MAX`  | 保留指令                             |

开启中断相应：汇编表示为`EI`，权限控制指令编号为`0x00`

关闭中断相应：汇编表示为`DI`，权限控制指令编号为`0x01`   *保护模式下该指令无效*

开启保护模式：汇编表示为`EP`

二进制表示：系统指令编号为`0b010`
```  
         +--->[31:29]系统指令编号(0b010) 
         |                          
         v vvv                      
    0b0000 010C CCCC CCCC CCCC CCCC CCCC CCCC
              ^ ^^^^ ^^^^ ^^^^ ^^^^ ^^^^ ^^^^
              |
              +---> [24:0]权限控制指令编号
```

